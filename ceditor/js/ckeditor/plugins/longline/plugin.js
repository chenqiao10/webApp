CKEDITOR.plugins.add("longline", {  
	requires: ["button"],  
	init: function(a) {  
		a.addCommand("longline", CKEDITOR.plugins.longline.commands.longline);  
		a.ui.addButton("longline", {  
			label: "画长线",//调用dialog时显示的名称  
			command: "longline",  
			icon: this.path + "longline.png"//在toolbar中的图标  
		});  
     }  
   
});
CKEDITOR.plugins.longline = {
	commands: {
		longline: {
			exec: function (editor) {
				var type = document.getElementById("id_longlineType"),
					hasGutter = document.getElementById("id_hasGutter");
				var insertHTML = "";
				var finalValue = (hasGutter != null && hasGutter.value === "true") ? type.value + "-" : type.value;
				/**  			
				 * 1	: A4
				 * 2	: A3-2栏
				 * 3	：B4-2栏
				 * 5	：A3-3栏
				 * 6	：B4-3栏	
				 * 0	: 日常测验勾选给分
				 * -1	：日常测验手写给分
				 * Ps.参数后加“-”为有装订线的值
				 */
				//insertHTML = "<p></p><p style='border-bottom:0.2mm solid #000'></p><p></p>";
				
				switch(finalValue){
					case "1-"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "2-"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "3-"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "5-"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "1"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "2"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "3"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "5"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "6"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "-1"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
					case "0"	:insertHTML = "<p><span style='line-height:2.5'><u>&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;</u></span></p><p></p>";break;
				}
				
				var userAgent = navigator.userAgent;
				var isIE = !!window.ActiveXObject || "ActiveXObject" in window; //判断是否IE浏览器
				var isEdge = userAgent.indexOf("Edge") > -1;
				if(isIE || isEdge){
					insertHTML = insertHTML.replace(/&#12288;/g,"");
				}
				
				/* 添加空span使样式不影响下一行 */
				editor.insertHtml(insertHTML);
				
/*                 定位到末端 
				var range = editor.createRange();
            	range.moveToElementEditEnd(editor.editable());
            	range.select();*/
			}
		}
	}
};
   
